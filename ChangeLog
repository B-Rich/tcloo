2007-08-06  Donal K. Fellows  <donal.k.fellows@manchester.ac.uk>

	* generic/tclOO.decls (TclOONewProcMethod, TclOONewProcClassMethod):
	Added to internal stubs table.

	* generic/tclOOMethod.c (InvokeProcedureMethod, PushMethodCallFrame):
	Reorganize so that frame management is clearer and better supportive
	of Arnulf's requirements. This involves added a clientData pointer,
	moving a callback, and breaking out things so that less is held on the
	C stack, which is already fairly full...

2007-08-04  Donal K. Fellows  <dkf@users.sf.net>

	* generic/tclOO.c (Tcl_InvokeNextContext): Added function to allow
	third party method implementations to traverse the call chain.

2007-08-03  Donal K. Fellows  <donal.k.fellows@manchester.ac.uk>

	* generic/tclOOCall.c: Use 'inline' where possible.

	* generic/tclOOInfo.c (InfoObjectVarsCmd): Rewrote following Miguel
	Sofer's incompatible changes in the Tcl core's implementation of
	variables.

	* generic/tclOOMethod.c (TclOONewProcMethod)
	(TclOONewProcClassMethod, TclOOMakeProcObjectMethod)
	(TclOOMakeProcClassMethod): Split apart the code to create new
	procedure-like methods so that third-party code can plug into it more
	effectively, following suggestions from Arnulf Wiedemann.

2007-06-25  Donal K. Fellows  <dkf@users.sf.net>

	* generic/tclOOInt.h, generic/tclOOMethod.c (InvokeProcedureMethod):
	Removed the FRAME_IS_FILTER flag; it was never queried anywhere since
	it proved more reliable to get the is-filter info from elsewhere.
	Documented the other call-frame flags.

2007-06-16  Donal K. Fellows  <dkf@users.sf.net>

	* generic/tclOOMethod.c (InvokeProcedureMethod, TclOONewProcMethod)
	(TclOONewProcClassMethod, CloneProcedureMethod): Added a mechanism to
	allow control over whether a method is invoked in the namespace of the
	object that it was invoked upon (the old behaviour, and still the
	default) or the class that defined it (required for non-horrible
	support of Itcl). Not yet exposed to scripts.

	* generic/tclOO.c (Tcl_NewObjectInstance): When renaming an object
	during construction, make sure that it is not being renamed to itself.
	Thanks to Arnulf Wiedemann for spotting this.

2007-06-15  Donal K. Fellows  <dkf@users.sf.net>

	* generic/tclOOCall.c (methodNameType, TclOOStashContext)
	(DupMethodNameRep, FreeMethodNameRep, TclOOGetCallContext):
	* generic/tclOO.c (AllocObject, ObjectCmd): Cache call contexts in
	* generic/tclOOInt.h: Tcl_Obj internal representations for (hopefully)
	some speedup of method invokation.

2007-06-14  Miguel Sofer  <msofer@users.sf.net>

	* generic/tclOOMethod.c (InvokeProcedureMethod):
	* tclOOInt.h: Adaptation to a change in Tcl HEAD: renumbering the
	FRAME_IS_... flag values, using the new shorter api to
	TclObjInterpProcCore.

2007-06-12  Donal K. Fellows  <dkf@users.sf.net>

	* Makefile.in (gdb, gdbtest): Add targets for running a debugger that
	actually work on Windows.

	* generic/tclOOInfo.c (TclOOInitInfo): Plumb the introspection code
	into the Tcl core [info] command.

2007-06-11  Donal K. Fellows  <dkf@users.sf.net>

	* generic/tclOO.c (ClassCreateNs): Exposed the ability to create
	* doc/class.n: objects with particular namespaces for names to
	scripts.

	* generic/tclOO.c (Tcl_NewObjectInstance, Tcl_CopyObjectInstance):
	* doc/Class.3: Extended the C API to allow control over the naming of
	the object's namespace, exposing the change to AllocObject from
	yesterday. Not yet exposed to scripts.

	* generic/tclOOInfo.c (InfoObjectMethodsCmd): Enhanced the method
	* doc/ooInfo.n: introspection to make it easier for commands to find
	what the methods of an object are. Thanks to Mark Janssen for
	suggesting this.

2007-06-10  Donal K. Fellows  <dkf@users.sf.net>

	* generic/tclOO.c (AllocObject): Started writing code to allow control
	over the name of the object's namespace generated during object
	creation. This feature is not yet exposed outside this file.

	* generic/tclOOMethod.c: Split out the method handling code into its
	own source file; it's long enough and complex enough to warrant it.

2007-06-08  Donal K. Fellows  <dkf@users.sf.net>

	* generic/tclOO.c (Tcl_ObjectSetMetadata, Tcl_ClassSetMetadata): When
	deleting metadata, must delete the metadata. (Thanks to Arnulf
	Wiedemann for spotting!)

	* generic/tclOO.c (AllocClass, Tcl_NewObjectInstance): Make the class
	splicing work correctly so that the set of instances of oo::object and
	the set of subclasses of oo::class stay limited in size. Fixes the
	other part of the memory leak. [Bug 1732364]

2007-06-07  Donal K. Fellows  <dkf@users.sf.net>

	* generic/tclOO.c (ObjectNamespaceDeleted): Try to make the code leak
	less. This doesn't seem to be a complete fix of [Bug 1732364] but is
	covering at least one case that might have been hit...

	* generic/tclOO.c (NextObjCmd): Make this behave consistently with
	documentation and what is most useful in practice.

	* generic/tclOO.c (TclOOObjectName, SelfObjCmd, ObjectRenamedTrace):
	Added code to manage a cache of the command name for the [self object]
	command. It seems that this was previously a very slow command. In so
	doing, allow simplification of a lot of code.

2007-06-06  Donal K. Fellows  <dkf@users.sf.net>

	* Makefile.in (shell): Added target for convenience of interactive
	testing.

	* Makefile.in (benchmarks): Added some benchmarking scripts, based off
	* benchmarks/*.tcl:	    those in http://dada.perl.it/shootout/

	* doc/next.n: Substantial enhancements, including a demonstration of
	how a mixin and a filter can build a simple bolt-on method result
	memoization cache.

2007-06-05  Donal K. Fellows  <dkf@users.sf.net>

	* Makefile.in: Added targets for building docs and distributions and
	installing documentation.

2007-06-04  Donal K. Fellows  <dkf@users.sf.net>

	* doc/ooInfo.n: Added documentation for the introspection commands.

2007-06-03  Donal K. Fellows  <dkf@users.sf.net>

	* doc/Method.3: The other half of the C interface, being the part
	dealing with methods.

2007-06-02  Donal K. Fellows  <dkf@users.sf.net>

	* doc/Class.3: Started documenting the C interface.

2007-06-01  Donal K. Fellows  <dkf@users.sf.net>

	* doc/next.n: Added documentation for [next].
	* doc/my.n: Added documentation for [my].

2007-05-31  Donal K. Fellows  <dkf@users.sf.net>

	* doc/self.n: Added some documentation for [self].

	* generic/tclOO.c (InvokeForwardMethod, ObjectUnknown): Better fix
	for the unknown method handling.
	* doc/object.n: Document it correctly.

2007-05-30  Donal K. Fellows  <dkf@users.sf.net>

	* doc/copy.n: Started work on documenting oo::copy.

	* generic/tclOO.c (ObjectUnknown): Fixed possible crash when unknown
	method used directly.

	* configure.in: Detect sdx during configure time, not make time.

2007-05-29  Donal K. Fellows  <dkf@users.sf.net>

	* TclOO.rc, Makefile.in, configure.in: Horrific hacking to make the
	generated DLL have nice metadata on Windows.

	* doc/class.n: Started work on third documentation file.
	* doc/object.n: Started work on second documentation file.

2007-05-28  Donal K. Fellows  <dkf@users.sf.net>

	* doc/define.n: Completed the list of define subcommands, but not yet
	documented what they all do. Added basic example.

2007-05-24  Donal K. Fellows  <dkf@users.sf.net>

	* license.terms: Added, same license as Tcl/Tk.
	* doc/define.n: Started to write documentation.

2007-05-19  Donal K. Fellows  <dkf@users.sf.net>

	* Makefile.in (kit): Rewrote to make the building of a starkit work
	for myself. Also tried to separate out things substituted by configure
	from things that are not substituted. The build now _requires_ GNU
	make to work, since it is easier to control substitution with it.

2007-05-18  Donal K. Fellows  <dkf@users.sf.net>

	* Makefile.in (kit): Added _experimental_ code to build a starkit
	distribution of the code.
	* configure.in (PLATFORM): Added code to determine what platform we
	are building for, needed for making the build of the kit work right.

	* Makefile.in (pkgIndex.tcl): Update the statement of what version

	* tests/oo.test: Convert {expand} to {*}.
	* generic/tclOOInt.h, generic/tclOO.h: Remove obsolete comments.

	* configure.in, Makefile.in: Updated to latest TEA and corrected build
	system to work on more platforms.
	* pkgIndex.tcl (removed): This file now generated automatically.

	* generic/tclOO.c (Tcloo_Init, ObjectDeletedTrace)
	(Tcl_CopyObjectInstance, ObjectCmd): Remove unused variables.

	Initial check-in as an extension.
